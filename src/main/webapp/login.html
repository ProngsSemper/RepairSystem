<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="css/login.css" type="text/css">
    <title>广东金融学院后勤保修平台</title>
    <script src="js/jquery-1.12.4.js"></script>
<!--    <script src="js/screen/screen.js"></script>-->
    
    <style>
        .super-center{
            margin: 0 auto;
        }
    </style>
</head>
<body>
    <br><br><br><br>
    <div class="nav super-center">
        <img src="img/1.png" alt="" class="left-top">
        <img src="img/logo.png" alt="logo" class="logo">
        <div class="line"></div>
        <img src="img/name.png" alt="" class="name">
        <img src="img/1.png" alt="" class="right-top">
    </div>
    <div class="contant super-center">
        <div class="school">
            <img src="img/school1.gif" alt="" class="schoolImg">
            <img src="img/title1.png" alt="" class="tit">
        </div>
        <div class="login">
            <div class="loginBox">
                <form action="" method="post">
                    <input type="text" class="inputStyle stuId" name="stuId" placeholder="&nbsp;&nbsp;学号/教工号" id="id">
                    <input type="password" class="inputStyle stuPassword" name="stuPassword" placeholder="&nbsp;&nbsp;密码" id="password"><br>
                    <div class="remmber">
                        <!-- 验证码 -->
                        <input type="checkbox" class="square" name="remmber"><span class="tit-name">记住密码</span>
                    </div>   
                    <div class="check">
                        <input type="text" placeholder="&nbsp;&nbsp;验证码" class="checkInput" name="checkCode">
                        <a href="javascript:void(0)"  class="linkImg">
                            <img src="/checkCode" alt="图片加载失败" class="codeImg" id="vcode" onclick="refreshCode()">
                        </a>
                    </div>         
                    <div class="radio">
                        <input type="radio" name="identity" class="chose" checked><span class="tit-name" >学生</span>
                    </div>
                    <div class="radio">
                        <input type="radio" name="identity" class="chose"><span class="tit-name">管理员</span>
                    </div>
                    <div class="radio">   
                        <input type="radio" name="identity" class="chose"><span class="tit-name">工人</span>
                    </div>
                    <input type="button" name="" value="登录" class="Submit" id="login">
                </form>
            </div>
        </div>
    </div>
    <div class="footer super-center">
        <img src="img/1.png" alt="" class="left-bottom">
        <img src="img/title2.png" alt="" class="tit-under">
        <img src="img/1.png" alt="" class="right-bottom">
    </div>

</body>
</html>
<!-- 发送ajax请求 -->
<!-- lyr -->
<script>
    $(document).ready(function () {
        $('#login').click(
            function () {

                const uId = $('#id').val();
                const uPassword = $('#password').val();
                const radio = $("input[name='identity']:checked").val();

                if (!uId) {
                    alert("请输入账号！");
                    refreshCode();
                    return;
                }
                if (!uPassword) {
                    alert("请输入密码！");
                    refreshCode();
                    return;
                }


                $.ajax({
                    type: "post",
                    url: "user/login",

                    dataType: "json",
                    data: JSON.stringify({'id':uId,'password':uPassword,'radio':radio}),
                    success: function (ans) {
                        if(ans.code==200)
                        {
                            alert("登录成功");
                            refreshCode();
                            window.setTimeout("window.location.href='welcome.jsp'", 1000);
                        }else {
                            refreshCode();
                        }
                    }
                });


            }
        )
    })
</script>
<script>
    function refreshCode(){
        //1.获取验证码图片对象
        var vcode = document.getElementById("vcode");

        //2.设置其src属性，加时间戳
        vcode.src = "/checkCode?time="+new Date().getTime();
    }

</script>